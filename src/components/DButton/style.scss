@import "../../styles/color";
@import "../../styles/flex";
@import "../../styles/font";
@import "../../styles/media";
@import "../../styles/padding";
@import "../../styles/position";
@import "../../styles/options/optionShape";
@import "styleExtend";
@import "styleVar";

@mixin button() {
  @include buttonVar;
  @include buttonVarFab;
  @include buttonVarChip;
  @include flexInlineCenter;
  @include font('button');
  @include paddingX(var(--_bt-padding));
  @include select-none;
  --pr-palette: var(--basic-text);
  --rp-palette: var(--_bt-image-palette);
  background-color: var(--_bt-background);
  background-image: none;
  border-radius: var(--_bt-radius);
  box-shadow: var(--_bt-shadow);
  height: var(--_bt-height);
  line-height: 1;
  max-width: 100%;
  min-width: var(--_bt-min-width);
  text-overflow: ellipsis;
  transition-property: color, background-color, box-shadow;
  white-space: nowrap;

  @include afterAbsolute {
    border-color: var(--_bt-border);
    border-radius: inherit;
    border-width: 1px;
    transition-duration: var(--transition-large-expanding);
    transition-property: border-color;
  }
}

@mixin buttonIcon() {
  &__icon {
    transition-duration: inherit;
    transition-property: color, opacity, transform;

    &.bt-icon {
      margin-left: calc(var(--_bt-squeeze) * -1);
      margin-right: var(--_bt-gap);
    }

    &.bt-trailing {
      cursor: default;
      display: var(--_bt--ic-display, inline-block);
      margin-left: var(--_bt-gap);
      margin-right: calc(var(--_bt-squeeze) * -1);
      order: 9;
      position: relative;
      z-index: 4;
    }
  }
}

@mixin buttonText() {
  &__text {
    @include ellipsis;
    @include flexX;
    @include flexDynamic;
    display: var(--_bt--ic-display, flex);
    @content;

    & + .d-badge {
      margin-left: var(--_bt-space);
    }
  }
}

@mixin buttonProgress() {
  .d-progress.status-visible ~ *:not(.d-badge) {
    background-color: transparent;
    color: transparent;
    opacity: 0;
    @content;
  }
}

@mixin buttonTextColor() {
  &.appearance-text-color {
    @extend %text-color;
    @content;
  }
}

@mixin buttonOutlined() {
  &.appearance-outlined {
    @extend %text-color;
    @extend %border;
    @content;
  }
}

@mixin buttonOutlinedColor() {
  &.appearance-outlined-color {
    @extend %text-color;
    @extend %border-color;
    @content;
  }
}

@mixin buttonOutlinedContained() {
  &.appearance-outlined-contained {
    @extend %text-color;
    @extend %border-color;
    @extend %filled-status;
    @content;
  }
}

@mixin buttonContained() {
  &.appearance-contained {
    @extend %filled;
    --_bt-shadow: var(--shadow-type2);
    --_bt--hv-shadow: var(--shadow-type2);
    --_bt--ac-shadow: var(--shadow-type6);
    @content;
  }
}

@mixin buttonFab() {
  &.appearance-fab {
    @extend %filled;
    --_bt-gap: var(--_bt--fb-gap);
    --_bt-radius: var(--_bt--fb-radius);
    --_bt-padding: var(--_bt--fb-padding);

    --_bt-height: var(--_bt--fb-height);
    --_bt--sm-height: var(--_bt--fb--sm-height);
    --_bt--lg-height: var(--_bt--fb--lg-height);

    --_bt-shadow: var(--shadow-type5);
    --_bt--hv-shadow: var(--shadow-type5);
    --_bt--ac-shadow: var(--shadow-type7);
    @content;
  }
}

@mixin buttonChip() {
  &.appearance-chip {
    @extend %chip;
    @extend %chip-background;
    @extend %chip-selected;
    @content;
  }
}

@mixin buttonChipColor() {
  &.appearance-chip-color {
    @extend %text-color;
    @extend %chip;
    @extend %chip-background;
    @content;
  }
}

@mixin buttonChipOutlined() {
  &.appearance-chip-outlined {
    @extend %border;
    @extend %chip;
    @extend %chip-selected;
    @content;
  }
}

@mixin buttonSize() {
  &.size- {
    &small {
      --_bt-height: var(--_bt--sm-height);
    }

    &large {
      --_bt-height: var(--_bt--lg-height);
    }
  }
}

@mixin buttonShape() {
  @include optionShape;

  &.shape-pill &__icon {
    --ic-size: calc(var(--_bt-height) - (var(--_bt-space) * 2));
    --_bt-squeeze: calc(var(--_bt-padding) - var(--_bt-space));
  }
}

@mixin buttonAdaptive() {
  $this: &;

  @include mediaMaxList {
    @include mixinAdaptive;
  }

  &.adaptive-icon {
    @include mixinAdaptive;
  }

  &.adaptive-block {
    width: 100%;
  }
}

@mixin buttonLowercase() {
  &.option-lowercase {
    @include font('body2');
    @content;
  }
}

@mixin buttonDense() {
  &.option-dense {
    --_bt-padding: var(--_bt--dn-padding);
    @content;
  }
}

@mixin buttonStatus() {
  &:not(:disabled):not(.status-disabled):not(.status-readonly) {
    &:hover,
    &.status-hover {
      background-image: varColor(--_bt-image-palette, --opacity-container-hover, true);
      box-shadow: var(--_bt--hv-shadow);
    }

    &:focus,
    &.status-focus,
    &.status-selected {
      background-image: varColor(--_bt-image-palette, --opacity-container-focus, true);

      &::after {
        border-color: var(--_bt--fc-border);
      }
    }

    &:active,
    &.status-active {
      background-image: varColor(--_bt-image-palette, --opacity-container-dragged, true);
      box-shadow: var(--_bt--ac-shadow);

      &::after {
        border-color: var(--_bt--ac-border);
        transition-duration: var(--transition-flash);
      }
    }

    &.status-selected {
      --_bt-palette: var(--_bt-select-palette);
      z-index: 4;
    }

    &.status-dragged {
      box-shadow: var(--_bt--dr-shadow);
      z-index: 6;
    }
  }
}

@mixin buttonDisabled() {
  &:disabled,
  &.status-disabled {
    --basic-text: var(--disabled-type1);
    --basic-text-opacity: var(--opacity-surface-disabled);
    --_bt-palette: var(--disabled-type1);
    background-color: var(--_bt--ds-background, transparent);
    background-image: none;
    box-shadow: var(--_bt--ds-shadow, none);

    &::after {
      border-color: var(--_bt--ds-border, transparent);
      transition-duration: 0s;
    }
  }
}

@mixin buttonInit() {
  @include button;
  @include buttonIcon;
  @include buttonText;
  @include buttonProgress;

  @include buttonTextColor;
  @include buttonOutlined;
  @include buttonOutlinedColor;
  @include buttonOutlinedContained;
  @include buttonContained;
  @include buttonFab;
  @include buttonChip;
  @include buttonChipColor;
  @include buttonChipOutlined;

  @include buttonSize;
  @include buttonShape;
  @include buttonAdaptive;
  @include buttonLowercase;
  @include buttonDense;
  @include buttonStatus;
  @include buttonDisabled;
}
